<!-- HTML: rakugaki.html 完全自動版 -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>らくがきギャラリー</title>
  <link rel="stylesheet" href="css/style.css">
  <script src="main.js" defer></script>
</head>
<body>
  <div class="wrapper">
    <h1 class="main-title">らくがき</h1>

    <div id="gallery-container"></div>
  </div>

  <!-- モーダル -->
  <div id="modal" class="modal" onclick="closeModal(event)">
    <div class="modal-content" id="modalContent"></div>
  </div>

  <script>
    const GAS_ENDPOINT = "https://script.google.com/macros/s/AKfycbxDL5TGsSTTAmkRQg2QYLKamoC3EN3X6YcpOsCOkD3GHROSDWhHC0LTd-AznrKkR8rWbA/exec";

    fetch(GAS_ENDPOINT)
      .then(response => response.json())
      .then(data => {
        const container = document.getElementById("gallery-container");

        data.folders.forEach(group => {
          const groupBox = document.createElement("div");
          groupBox.className = "comic-group";

          const title = document.createElement("div");
          title.className = "comic-caption";
          title.textContent = group.title;
          groupBox.appendChild(title);

          const scrollBox = document.createElement("div");
          scrollBox.className = "comic-scroll";

          const thumb = document.createElement("div");
          thumb.className = "comic-card";

          const img = document.createElement("img");
          img.className = "thumbnail";
          img.src = group.images[0];
          img.onclick = () => openSeries(group.images);

          thumb.appendChild(img);
          scrollBox.appendChild(thumb);
          groupBox.appendChild(scrollBox);
          container.appendChild(groupBox);
        });
      });

    function openSeries(images) {
      const modal = document.getElementById("modal");
      const content = document.getElementById("modalContent");
      content.innerHTML = "";

      images.forEach(url => {
        const img = document.createElement("img");
        img.src = url;
        img.className = "modal-image";
        content.appendChild(img);
      });

      modal.style.display = "flex";
    }

    function closeModal(event) {
      if (event.target.id === "modal") {
        document.getElementById("modal").style.display = "none";
      }
    }
  </script>
</body>
</html>
